#include <stdio.h>
#include <string.h>

char page[65][65];

char C5[][5][7] = {
  {".***..",
   "*...*.",
   "*****.",
   "*...*.",
   "*...*.",},

  {"****..",
   "*...*.",
   "****..",
   "*...*.",
   "****..",},

  {".****.",
   "*...*.",
   "*.....",
   "*.....",
   ".****.",},

  {"****..",
   "*...*.",
   "*...*.",
   "*...*.",
   "****..",},

  {"*****.",
   "*.....",
   "***...",
   "*.....",
   "*****.",},

  {"*****.",
   "*.....",
   "***...",
   "*.....",
   "*.....",},

  {".****.",
   "*.....",
   "*..**.",
   "*...*.",
   ".***..",},

  {"*...*.",
   "*...*.",
   "*****.",
   "*...*.",
   "*...*.",},

  {"*****.",
   "..*...",
   "..*...",
   "..*...",
   "*****.",},

  {"..***.",
   "...*..",
   "...*..",
   "*..*..",
   ".**...",},

  {"*...*.",
   "*..*..",
   "***...",
   "*..*..",
   "*...*.",},

  {"*.....",
   "*.....",
   "*.....",
   "*.....",
   "*****.",},

  {"*...*.",
   "**.**.",
   "*.*.*.",
   "*...*.",
   "*...*.",},

  {"*...*.",
   "**..*.",
   "*.*.*.",
   "*..**.",
   "*...*.",},

  {".***..",
   "*...*.",
   "*...*.",
   "*...*.",
   ".***..",},

  {"***...",
   "*...*.",
   "****..",
   "*.....",
   "*.....",},

  {".***..",
   "*...*.",
   "*...*.",
   "*..**.",
   ".****.",},

  {"****..",
   "*...*.",
   "****..",
   "*..*..",
   "*...*.",},

  {".****.",
   "*.....",
   ".***..",
   "....*.",
   "****..",},

  {"*****.",
   "*.*.*.",
   "..*...",
   "..*...",
   ".***..",},

  {"*...*.",
   "*...*.",
   "*...*.",
   "*...*.",
   ".***..",},

  {"*...*.",
   "*...*.",
   ".*.*..",
   ".*.*..",
   "..*...",},

  {"*...*.",
   "*...*.",
   "*.*.*.",
   "**.**.",
   "*...*.",},

  {"*...*.",
   ".*.*..",
   "..*...",
   ".*.*..",
   "*...*.",},

  {"*...*.",
   ".*.*..",
   "..*...",
   "..*...",
   "..*...",},

  {"*****.",
   "...*..",
   "..*...",
   ".*....",
   "*****.",},
};



void init() {
  for (int i = 0; i < 65; i++)  
    for (int j = 0; j < 65; j++)
      page[i][j] = '.';
}

int main(void)
{
  char cmd[5];
  char s[100];
  char F[5];
  int R, C, len, start;

  init();

  while (EOF != scanf("%s ", cmd)) {

    if (!strcmp(cmd, ".EOP")) {
      for (int i = 1; i <= 60; i++) {
        for (int j = 0; j < 60; j++)
          printf("%c", page[i][j]);
        puts("");
      }

      puts("");
      for (int i = 0; i < 60; i++)
        printf("-");
      puts("");
      puts("");

      init();
      continue;
    }
    
    scanf("%s %d ", F, &R);

    if (!strcmp(cmd, ".P"))
      scanf("%d ", &C);
    gets(s);

    if (!strcmp(cmd, ".P")) {
      start = C - 1;
    } else if (!strcmp(cmd, ".L")) {
      start = 0;
    } else if (!strcmp(cmd, ".R")) {

      for (len = 1; s[len] != '|'; len++);
      if (F[1] == '1') {
        start = 60 - len + 1;
      } else {
        start = 60 - (len-1)*6;  
      }

    } else if (!strcmp(cmd, ".C")) {
      for (len = 1; s[len] != '|'; len++);

      if (F[1] == '1') {
        start = 30 - (len-1)/2;
      } else {
        start = 30 - (len-1)*6/2;
      }

    }

    if (F[1] == '1') {
      for (int i = 1; s[i] != '|'; i++)
        if (start+i-1 >= 0 && start+i-1 < 60 && s[i] != ' ')
          page[R][start+i-1] = s[i];
    } else {
      for (int i = 1; s[i] != '|'; i++) {
        for (int j = 0; j < 6; j++)
          for (int k = 0; k < 5; k++)
            if (start+(i-1)*6+j >= 0 && start+(i-1)*6+j < 60 && R+k <= 60 && s[i] != ' ')
              if (C5[s[i]-'A'][k][j] == '*')
                page[R+k][start+(i-1)*6+j] = C5[s[i]-'A'][k][j];
      }
    }
  }

  return 0;
}

